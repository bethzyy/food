<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title data-i18n="page.title">养生饮食推荐</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container" id="app">
        <!-- 头部标题区 -->
        <header class="app-header">
            <h1 data-i18n="app.title">时令养生膳食</h1>
            <p class="subtitle" data-i18n="app.subtitle">顺应四时 调和阴阳</p>
            <button id="langToggleBtn" class="lang-icon-btn" title="切换语言/Switch Language">
                <span class="lang-icon">🌐</span>
            </button>
        </header>

        <!-- 主要内容区 -->
        <main class="main-content">
            <!-- 环境信息综合区 -->
            <section class="section environment-section">
                <h2 class="section-title">
                    <span class="section-icon">🏛️</span>
                    <span data-i18n="section.environment">天时地利</span>
                    <!-- 农历节气显示靠右 -->
                    <span class="lunar-term-display" id="ganzhiDisplay"></span>
                </h2>

                <!-- 日期时间位置天气第一行 -->
                <div class="compact-info-row">
                    <div class="compact-item">
                        <label data-i18n="label.date">公历</label>
                        <input type="date" id="dateInput" class="compact-input">
                    </div>
                    <div class="compact-item">
                        <label data-i18n="label.time">时辰</label>
                        <input type="time" id="timeInput" class="compact-input">
                    </div>
                    <div class="compact-item">
                        <label data-i18n="label.location">天地</label>
                        <select id="locationSelect" class="compact-select">
                            <option value="北京">北京</option>
                            <option value="上海">上海</option>
                            <option value="广州">广州</option>
                            <option value="深圳">深圳</option>
                            <option value="杭州">杭州</option>
                            <option value="成都">成都</option>
                            <option value="重庆">重庆</option>
                            <option value="武汉">武汉</option>
                            <option value="西安">西安</option>
                            <option value="南京">南京</option>
                            <option value="苏州">苏州</option>
                            <option value="天津">天津</option>
                            <option value="长沙">长沙</option>
                            <option value="郑州">郑州</option>
                            <option value="济南">济南</option>
                            <option value="青岛">青岛</option>
                            <option value="大连">大连</option>
                            <option value="沈阳">沈阳</option>
                            <option value="哈尔滨">哈尔滨</option>
                            <option value="昆明">昆明</option>
                            <option value="厦门">厦门</option>
                            <option value="福州">福州</option>
                            <option value="南宁">南宁</option>
                            <option value="贵阳">贵阳</option>
                            <option value="兰州">兰州</option>
                            <option value="太原">太原</option>
                            <option value="南昌">南昌</option>
                            <option value="合肥">合肥</option>
                            <option value="乌鲁木齐">乌鲁木齐</option>
                            <option value="拉萨">拉萨</option>
                            <option value="海口">海口</option>
                            <option value="三亚">三亚</option>
                        </select>
                    </div>
                    <div class="compact-item">
                        <label data-i18n="label.weather">天候</label>
                        <select id="weatherSelect" class="compact-select">
                            <option value="晴">晴</option>
                            <option value="多云">多云</option>
                            <option value="阴">阴</option>
                            <option value="雨">雨</option>
                            <option value="雪">雪</option>
                            <option value="雾">雾</option>
                            <option value="大风">风</option>
                            <option value="沙尘">尘</option>
                        </select>
                    </div>
                </div>

                <!-- 用膳时段第二行 -->
                <div class="meal-period-row">
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="早餐" data-i18n-value="meal.breakfast" checked>
                        <span class="radio-text" data-i18n="meal.breakfast">🌅 晨起</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="午餐" data-i18n-value="meal.lunch">
                        <span class="radio-text" data-i18n="meal.lunch">☀️ 日中</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="晚餐" data-i18n-value="meal.dinner">
                        <span class="radio-text" data-i18n="meal.dinner">🌙 日暮</span>
                    </label>
                </div>
            </section>

            <!-- 因人制宜选择区 -->
            <section class="section meal-type-section">
                <h2 class="section-title">
                    <span class="section-icon">🥢</span>
                    <span data-i18n="section.personalization">因人制宜</span>
                </h2>
                <div class="diet-type">
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="日常饮食" data-i18n-value="diet.regular" checked>
                        <span class="radio-text" data-i18n="diet.regular">🥗 日常饮食</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="药膳饮食" data-i18n-value="diet.medicinal">
                        <span class="radio-text" data-i18n="diet.medicinal">🏮 药膳调理</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="茶饮推荐" data-i18n-value="diet.tea">
                        <span class="radio-text" data-i18n="diet.tea">🍵 茶饮养生</span>
                    </label>
                </div>
                <div class="health-goal">
                    <label class="radio-label">
                        <input type="radio" name="healthGoal" value="健脾" data-i18n-value="goal.spleen" checked>
                        <span class="radio-text" data-i18n="goal.spleen">🫐 健脾</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="healthGoal" value="安神" data-i18n-value="goal.calming">
                        <span class="radio-text" data-i18n="goal.calming">😴 安神</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="healthGoal" value="清火" data-i18n-value="goal.fire">
                        <span class="radio-text" data-i18n="goal.fire">🔥 清火</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="healthGoal" value="祛湿" data-i18n-value="goal.dampness">
                        <span class="radio-text" data-i18n="goal.dampness">💧 祛湿</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="healthGoal" value="美白" data-i18n-value="goal.whitening">
                        <span class="radio-text" data-i18n="goal.whitening">✨ 美白</span>
                    </label>
                </div>
            </section>

            <!-- 生成推荐按钮 -->
            <section class="section action-section">
                <button id="generateBtn" class="primary-btn" data-i18n="button.generate">🌟 饮食推荐</button>
            </section>

            <!-- 推荐结果展示区 -->
            <section class="section result-section" id="resultSection" style="display: none;">

                <!-- 饮食建议 -->
                <div class="info-card recommendation-card">
                    <h3 class="card-title">
                        <span class="section-icon">🍲</span>
                        <span data-i18n="dish.title">时令佳肴</span>
                    </h3>
                    <div class="card-content" id="recommendationContent">
                        <div class="loading" id="loadingSpinner">
                            <div class="spinner"></div>
                            <p data-i18n="loading.generating">正在为您开具食疗良方...</p>
                        </div>
                    </div>
                </div>

                <!-- 营养分析 -->
                <div class="info-card nutrition-card" id="nutritionCard" style="display: none;">
                    <h3 class="card-title">
                        <span class="section-icon">📊</span>
                        <span data-i18n="nutrition.title">营养概览</span>
                    </h3>
                    <div class="card-content" id="nutritionContent"></div>
                    <div class="nutrition-chart">
                        <canvas id="nutritionChart"></canvas>
                    </div>
                </div>
            </section>
        </main>

        <!-- 页脚 -->
        <footer class="app-footer">
            <p data-i18n="footer.motto">秉承中医养生之道</p>
            <p class="footer-note" data-i18n="footer.ai">由智能大模型出品</p>
        </footer>
    </div>

    <!-- API Key输入模态框 -->
    <div id="apiKeyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2 data-i18n="modal.apikey.title">🔑 配置API Key</h2>
            <p data-i18n="modal.apikey.description">请输入您的智谱AI API Key以继续使用</p>
            <div class="input-group">
                <input type="password" id="apiKeyInput" data-i18n-placeholder="modal.apikey.placeholder" placeholder="请输入API Key (格式: id.secret)">
                <button id="saveApiKeyBtn" class="primary-btn" data-i18n="button.save">保存</button>
            </div>
            <div class="api-key-help">
                <p data-i18n="modal.apikey.help_title">📖 如何获取API Key:</p>
                <ol>
                    <li data-i18n="modal.apikey.help_step1">访问 <a href="https://open.bigmodel.cn/" target="_blank">https://open.bigmodel.cn/</a></li>
                    <li data-i18n="modal.apikey.help_step2">注册并登录账号</li>
                    <li data-i18n="modal.apikey.help_step3">在控制台获取API Key</li>
                </ol>
                <p class="note" data-i18n="modal.apikey.help_note">💾 API Key将保存在浏览器本地,下次无需再次输入</p>
            </div>
        </div>
    </div>

    <!-- 引入Chart.js用于图表 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- 引入lunar-javascript农历库 -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <!-- 引入国际化系统 -->
    <script src="i18n.js?v=31"></script>
    <script src="app.js?v=37"></script>
    <link rel="stylesheet" href="style.css?v=31">
</body>
</html>
