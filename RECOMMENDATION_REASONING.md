# 推荐理由功能说明

## 功能概述

推荐理由从**三大学科角度**综合分析这套餐饮的益处和推荐原因，为用户提供专业、全面的养生指导。

---

## 三大分析角度

### 🏥 1. 中医养生角度

从传统中医理论出发，分析食疗的养生原理：

- **整体配伍**：分析菜品的君臣佐使配伍原理
- **性味归经**：说明食材的四气五味如何调和阴阳
- **脏腑调养**：阐述如何滋养五脏六腑、调和气血
- **养生功效**：引《黄帝内经》《本草纲目》等经典论述功效

**示例**：
```
中医养生角度
├── 整体配伍：以当归为君，生姜为臣，羊肉为佐，炙甘草为使
├── 性味归经：当归甘温补血，生姜辛温散寒，羊肉甘热助阳
├── 脏腑调养：温补脾肾，调和气血，扶正祛邪
└── 养生功效：《本草纲目》载："当归补血活血，生姜温中散寒"
```

---

### 🌸 2. 时令养生角度

结合当前时令天气，阐述因时制宜的养生智慧：

- **节气之理**：引《黄帝内经》阐释当前节气养生法则
- **天气之辨**：分析天气对人体的影响及饮食调摄方法
- **季节之养**：说明季节养生大法
- **因时制宜**：结合当前时辰的饮食宜忌

**示例**：
```
时令养生角度
├── 节气之理：小寒时节，阴极阳生，宜温补阳气
├── 天气之辨：寒气袭人，易伤脾胃，当食温热之物
├── 季节之养：冬季养藏，顺应闭藏之气，培元固本
└── 因时制宜：晚餐时节，阳气内敛，宜食温补易消化之物
```

---

### 🔬 3. 现代营养学角度

用现代营养科学验证食疗方案的科学性：

- **营养均衡**：分析三大营养素配比是否科学合理
- **微量元素**：说明维生素、矿物质含量及功效
- **热量适宜**：评估总热量是否符合餐次需求
- **科学论证**：引用现代营养学研究证实

**示例**：
```
现代营养学角度
├── 营养均衡：蛋白质15%、脂肪25%、碳水化合物60%，符合均衡膳食原则
├── 微量元素：富含维生素C、维生素E、铁、锌，增强免疫力
├── 热量适宜：总热量650大卡，符合晚餐需求
└── 科学论证：《中国居民膳食指南》推荐：适量摄入优质蛋白
```

---

## 数据结构

### JSON格式

```json
{
    "reasoning": {
        "chineseMedicine": {
            "title": "中医养生角度",
            "compatibility": "整体配伍：君臣佐使配伍原理分析",
            "natureFlavor": "性味归经：四气五味如何调和阴阳",
            "organNourishment": "脏腑调养：如何滋养五脏六腑、调和气血",
            "effects": "养生功效：引经典论述的功效"
        },
        "seasonal": {
            "title": "时令养生角度",
            "solarTerm": "节气之理：引《黄帝内经》阐释节气养生法则",
            "weather": "天气之辨：天气对人体的影响及饮食调摄",
            "season": "季节之养：季节养生大法",
            "timing": "因时制宜：结合当前时辰的饮食宜忌"
        },
        "nutrition": {
            "title": "现代营养学角度",
            "balance": "营养均衡：三大营养素配比分析",
            "micronutrients": "微量元素：维生素矿物质含量及功效",
            "calories": "热量适宜：总热量是否符合餐次需求",
            "science": "科学论证：现代营养学研究证实"
        }
    }
}
```

---

## 显示效果

### 页面布局

推荐理由卡片位于"时令佳肴"和"营养概览"之后，与它们并列展示：

```
┌─────────────────────────────────────┐
│ 📜 养生良方                          │
├─────────────────────────────────────┤
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 🍲 时令佳肴                     │ │
│ │ [菜品卡片网格]                   │ │
│ └─────────────────────────────────┘ │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 📊 营养概览                     │ │
│ │ [营养图表]                       │ │
│ └─────────────────────────────────┘ │
│                                      │
│ ┌─────────────────────────────────┐ │
│ │ 💡 推荐理由                     │ │
│ │                                  │ │
│ │ [每道菜推荐理由 - 网格布局]      │ │
│ │   1. 菜名 - 一句话推荐           │ │
│ │   2. 菜名 - 一句话推荐           │ │
│ │   3. 菜名 - 一句话推荐           │ │
│ │                                  │ │
│ │ ┌────────────────────────────┐  │ │
│ │ │ 🏥 中医养生角度            │  │ │
│ │ │ 整体配伍：...              │  │ │
│ │ │ 性味归经：...              │  │ │
│ │ │ 脏腑调养：...              │  │ │
│ │ │ 养生功效：...              │  │ │
│ │ └────────────────────────────┘  │ │
│ │                                  │ │
│ │ ┌────────────────────────────┐  │ │
│ │ │ 🌸 时令养生角度            │  │ │
│ │ │ 节气之理：...              │  │ │
│ │ │ 天气之辨：...              │  │ │
│ │ │ 季节之养：...              │  │ │
│ │ │ 因时制宜：...              │  │ │
│ │ └────────────────────────────┘  │ │
│ │                                  │ │
│ │ ┌────────────────────────────┐  │ │
│ │ │ 🔬 现代营养学角度          │  │ │
│ │ │ 营养均衡：...              │  │ │
│ │ │ 微量元素：...              │  │ │
│ │ │ 热量适宜：...              │  │ │
│ │ │ 科学论证：...              │  │ │
│ │ └────────────────────────────┘  │ │
│ │                                  │ │
│ └─────────────────────────────────┘ │
│                                      │
└─────────────────────────────────────┘
```

---

## 样式特性

### 视觉设计
- **卡片分隔**：每个角度用独立的卡片展示，清晰易读
- **标题强调**：使用emoji和彩色标题区分不同角度
- **边框分隔**：标题下方添加分隔线，增强层次感
- **标签对齐**：所有标签（整体配伍、性味归经等）左对齐，宽度一致

### 交互效果
- **悬停效果**：菜品推荐理由卡片悬停时轻微上浮
- **动画效果**：卡片淡入动画，提升视觉体验
- **响应式布局**：移动端自动调整为单列布局

---

## 兼容性

### 向后兼容
系统保留了旧格式的支持，如果AI返回旧格式的reasoning数据：

```json
{
    "reasoning": {
        "solarTerm": "节气养生依据",
        "weather": "天气因素考量",
        "season": "季节养生原理",
        "nutrition": "现代营养学论证",
        "materiaMedica": "药理分析"
    }
}
```

系统会自动显示为"🌟 综合推荐"卡片，确保旧数据也能正常显示。

---

## 使用说明

### 用户体验

1. **生成推荐**：点击"🌟 饮食推荐"按钮
2. **查看菜品**：在"时令佳肴"中查看推荐的菜品和食材
3. **了解营养**：在"营养概览"中查看营养分析
4. **深入理解**：在"推荐理由"中：
   - 快速浏览每道菜的一句话推荐
   - 从中医角度理解养生原理
   - 从时令角度了解因时制宜
   - 从营养学角度验证科学性

### 专业指导

- **中医爱好者**：重点关注"中医养生角度"
- **时令养生者**：重点关注"时令养生角度"
- **营养学关注者**：重点关注"现代营养学角度"
- **综合养生者**：全面阅读三个角度，融会贯通

---

## 技术实现

### 文件修改

1. **Prompt模板** (`prompts/food_recommendation_prompt.txt`)
   - 修改reasoning部分，明确要求从三个角度展开
   - 更新JSON schema，增加嵌套结构

2. **前端显示** (`app.js`)
   - 创建`displayReasoning()`方法
   - 支持新格式和旧格式
   - 生成三个角度的HTML结构

3. **样式设计** (`style.css`)
   - 添加reasoning-card样式
   - 添加reasoning-grid网格布局
   - 添加overall-reasoning卡片样式
   - 添加响应式适配

4. **页面结构** (`index.html`)
   - 添加reasoningCard容器
   - 与nutritionCard并列显示

---

## 示例输出

### 完整示例

```json
{
    "dishes": [
        {
            "name": "当归生姜羊肉汤",
            "type": "汤品",
            "reasoning": "温阳散寒，补气养血，小寒时节最佳"
        }
    ],
    "reasoning": {
        "chineseMedicine": {
            "title": "中医养生角度",
            "compatibility": "以当归为君，生姜为臣，羊肉为佐，炙甘草为使，君臣佐使配伍严谨",
            "natureFlavor": "当归甘温补血，生姜辛温散寒，羊肉甘热助阳，三味合用，温补而不燥烈",
            "organNourishment": "温补脾肾之阳，调和气血，扶正祛邪，对虚寒体质尤为适宜",
            "effects": "《金匮要略》载：'当归生姜羊肉汤，治寒疝腹中痛，及胁痛里急者'"
        },
        "seasonal": {
            "title": "时令养生角度",
            "solarTerm": "小寒时节，阴极阳生，宜温补阳气，为春季生发奠基",
            "weather": "寒气袭人，易伤脾胃阳气，当食温热之物以护阳",
            "season": "冬季养藏，顺应闭藏之气，培元固本，为来年春生做好准备",
            "timing": "晚餐时节，阳气内敛，宜食温补易消化之物，助夜间潜藏"
        },
        "nutrition": {
            "title": "现代营养学角度",
            "balance": "蛋白质18%、脂肪22%、碳水化合物60%，符合均衡膳食原则",
            "micronutrients": "富含铁、锌、维生素B12，促进造血功能，增强免疫力",
            "calories": "总热量320大卡，适合作为晚餐汤品",
            "science": "《中国居民膳食指南》推荐：冬季适量增加温性食材，促进血液循环"
        }
    }
}
```

---

## 总结

推荐理由功能通过**三大学科角度**的综合分析，为用户提供：

✅ **专业权威**：基于中医经典和现代营养学
✅ **因时制宜**：结合当前节气天气和时辰
✅ **科学验证**：现代营养学研究支持
✅ **易于理解**：结构化展示，清晰明了

让用户不仅能知道"吃什么"，更能深入理解"为什么吃"，真正做到知其然更知其所以然。
