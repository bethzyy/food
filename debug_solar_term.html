<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠ‚æ°”è°ƒè¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
</head>
<body>
    <h1>èŠ‚æ°”è°ƒè¯• - 2026å¹´1æœˆ6æ—¥</h1>
    <div id="result"></div>

    <script>
        const date = new Date(2026, 0, 6); // 2026å¹´1æœˆ6æ—¥
        const solar = Solar.fromDate(date);
        const lunar = solar.getLunar();

        let html = '<h2>æµ‹è¯•ç»“æœ:</h2>';
        html += '<p><strong>æµ‹è¯•æ—¥æœŸ:</strong> ' + date.toISOString().split('T')[0] + '</p>';
        html += '<p><strong>å†œå†:</strong> ' + lunar.toString() + '</p>';

        // è·å–ä¸Šä¸€ä¸ªèŠ‚æ°”
        html += '<h3>ä¸Šä¸€ä¸ªèŠ‚æ°” (getPrevJie):</h3>';
        try {
            const prevJie = lunar.getPrevJie(false);
            if (prevJie) {
                html += '<p><strong>åç§°:</strong> ' + prevJie.getName() + '</p>';
                html += '<p><strong>æ—¥æœŸ:</strong> ' + prevJie.toString() + '</p>';

                const prevJieStr = prevJie.toString();
                const match = prevJieStr.match(/(\d{4})-(\d{2})-(\d{2})/);
                if (match) {
                    const prevJieDate = new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
                    const daysDiff = Math.floor((date - prevJieDate) / (1000 * 60 * 60 * 24));
                    html += '<p><strong>è·ç¦»ä»Šå¤©:</strong> ' + daysDiff + ' å¤©</p>';
                    html += '<p><strong>åº”è¯¥åœ¨0-2å¤©å†…æ˜¾ç¤º: ' + (daysDiff >= 0 && daysDiff <= 2 ? 'æ˜¯' : 'å¦') + '</p>';
                }
            } else {
                html += '<p>æ— æ³•è·å–ä¸Šä¸€ä¸ªèŠ‚æ°”</p>';
            }
        } catch(e) {
            html += '<p style="color: red;">é”™è¯¯: ' + e.message + '</p>';
        }

        // è·å–ä¸‹ä¸€ä¸ªèŠ‚æ°”
        html += '<h3>ä¸‹ä¸€ä¸ªèŠ‚æ°” (getNextJie):</h3>';
        try {
            const nextJie = lunar.getNextJie(false);
            if (nextJie) {
                html += '<p><strong>åç§°:</strong> ' + nextJie.getName() + '</p>';
                html += '<p><strong>æ—¥æœŸ:</strong> ' + nextJie.toString() + '</p>';

                const nextJieStr = nextJie.toString();
                const match = nextJieStr.match(/(\d{4})-(\d{2})-(\d{2})/);
                if (match) {
                    const nextJieDate = new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
                    const daysDiff = Math.floor((nextJieDate - date) / (1000 * 60 * 60 * 24));
                    html += '<p><strong>è·ç¦»ä»Šå¤©:</strong> ' + daysDiff + ' å¤©</p>';
                    html += '<p><strong>åº”è¯¥åœ¨0-2å¤©å†…æ˜¾ç¤º: ' + (daysDiff >= 0 && daysDiff <= 2 ? 'æ˜¯' : 'å¦') + '</p>';
                }
            } else {
                html += '<p>æ— æ³•è·å–ä¸‹ä¸€ä¸ªèŠ‚æ°”</p>';
            }
        } catch(e) {
            html += '<p style="color: red;">é”™è¯¯: ' + e.message + '</p>';
        }

        // æµ‹è¯•ä¸åŒæ—¥æœŸ
        html += '<h2>æµ‹è¯•å¤šä¸ªæ—¥æœŸ:</h2>';
        const testDates = [
            new Date(2026, 0, 4),  // 1æœˆ4æ—¥
            new Date(2026, 0, 5),  // 1æœˆ5æ—¥ å°å¯’
            new Date(2026, 0, 6),  // 1æœˆ6æ—¥
            new Date(2026, 0, 7),  // 1æœˆ7æ—¥
            new Date(2026, 0, 8),  // 1æœˆ8æ—¥
        ];

        testDates.forEach(testDate => {
            const dateStr = testDate.toISOString().split('T')[0];
            const testSolar = Solar.fromDate(testDate);
            const testLunar = testSolar.getLunar();
            const prevJie = testLunar.getPrevJie(false);

            let result = '';
            if (prevJie) {
                const prevJieStr = prevJie.toString();
                const match = prevJieStr.match(/(\d{4})-(\d{2})-(\d{2})/);
                if (match) {
                    const prevJieDate = new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
                    const daysDiff = Math.floor((testDate - prevJieDate) / (1000 * 60 * 60 * 24));

                    if (daysDiff === 0) {
                        result = `âœ¨ ä»Šæ—¥${prevJie.getName()} âœ¨`;
                    } else if (daysDiff === 1) {
                        result = `ğŸ“… æ˜¨æ—¥${prevJie.getName()}`;
                    } else if (daysDiff === 2) {
                        result = `ğŸ“… å‰æ—¥${prevJie.getName()}`;
                    } else if (daysDiff >= 0 && daysDiff <= 14) {
                        result = `Â· ${prevJie.getName()} (ä¸åœ¨å‰å2å¤©å†…)`;
                    } else {
                        result = `(è·ç¦»ä¸Šä¸€ä¸ªèŠ‚æ°”${daysDiff}å¤©,ä¸æ˜¾ç¤º)`;
                    }
                }
            }
            html += `<p><strong>${dateStr}:</strong> ${result}</p>`;
        });

        document.getElementById('result').innerHTML = html;
    </script>
</body>
</html>
