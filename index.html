<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>养生饮食推荐</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container" id="app">
        <!-- 头部标题区 -->
        <header class="app-header">
            <h1>时令膳食</h1>
            <p class="subtitle">顺应四时 调和阴阳</p>
            <button id="langToggleBtn" class="lang-icon-btn" title="切换语言/Switch Language">
                <span class="lang-icon">🌐</span>
            </button>
        </header>

        <!-- 主要内容区 -->
        <main class="main-content">
            <!-- 环境信息综合区 -->
            <section class="section environment-section">
                <h2 class="section-title" data-i18n="section.environment">🌸 天时地利</h2>

                <!-- 天干地支和节气显示 -->
                <div class="ganzgi-solar-term-row">
                    <div class="ganzhi-display" id="ganzhiDisplay">
                        正在计算天干地支、节气和农历...
                    </div>
                </div>

                <!-- 日期时间位置天气综合行 -->
                <div class="compact-info-row">
                    <div class="compact-item">
                        <label data-i18n="label.date">黄历</label>
                        <input type="date" id="dateInput" class="compact-input">
                    </div>
                    <div class="compact-item">
                        <label data-i18n="label.time">时辰</label>
                        <input type="time" id="timeInput" class="compact-input">
                    </div>
                    <div class="compact-item">
                        <label data-i18n="label.location">天地</label>
                        <select id="locationSelect" class="compact-select">
                            <option value="北京">北京</option>
                            <option value="上海">上海</option>
                            <option value="广州">广州</option>
                            <option value="深圳">深圳</option>
                            <option value="杭州">杭州</option>
                            <option value="成都">成都</option>
                            <option value="重庆">重庆</option>
                            <option value="武汉">武汉</option>
                            <option value="西安">西安</option>
                            <option value="南京">南京</option>
                            <option value="苏州">苏州</option>
                            <option value="天津">天津</option>
                            <option value="长沙">长沙</option>
                            <option value="郑州">郑州</option>
                            <option value="济南">济南</option>
                            <option value="青岛">青岛</option>
                            <option value="大连">大连</option>
                            <option value="沈阳">沈阳</option>
                            <option value="哈尔滨">哈尔滨</option>
                            <option value="昆明">昆明</option>
                            <option value="厦门">厦门</option>
                            <option value="福州">福州</option>
                            <option value="南宁">南宁</option>
                            <option value="贵阳">贵阳</option>
                            <option value="兰州">兰州</option>
                            <option value="太原">太原</option>
                            <option value="南昌">南昌</option>
                            <option value="合肥">合肥</option>
                            <option value="乌鲁木齐">乌鲁木齐</option>
                            <option value="拉萨">拉萨</option>
                            <option value="海口">海口</option>
                            <option value="三亚">三亚</option>
                        </select>
                    </div>
                    <div class="compact-item">
                        <label>天候</label>
                        <select id="weatherSelect" class="compact-select">
                            <option value="晴">晴</option>
                            <option value="多云">多云</option>
                            <option value="阴">阴</option>
                            <option value="雨">雨</option>
                            <option value="雪">雪</option>
                            <option value="雾">雾</option>
                            <option value="大风">风</option>
                            <option value="沙尘">尘</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- 饮食类型选择区 -->
            <section class="section meal-type-section">
                <h2 class="section-title" data-i18n="section.meal">🍽️ 用膳之时</h2>
                <div class="meal-period">
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="早餐" data-i18n-value="meal.breakfast" checked>
                        <span class="radio-text" data-i18n="meal.breakfast">🌅 晨起</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="午餐" data-i18n-value="meal.lunch">
                        <span class="radio-text" data-i18n="meal.lunch">☀️ 日中</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mealPeriod" value="晚餐" data-i18n-value="meal.dinner">
                        <span class="radio-text" data-i18n="meal.dinner">🌙 日暮</span>
                    </label>
                </div>
                <div class="diet-type">
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="日常饮食" data-i18n-value="diet.regular" checked>
                        <span class="radio-text" data-i18n="diet.regular">🥗 日常饮食</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="药膳饮食" data-i18n-value="diet.medicinal">
                        <span class="radio-text" data-i18n="diet.medicinal">🏮 药膳调理</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="dietType" value="茶饮推荐" data-i18n-value="diet.tea">
                        <span class="radio-text" data-i18n="diet.tea">🍵 茶饮养生</span>
                    </label>
                </div>
            </section>

            <!-- 生成推荐按钮 -->
            <section class="section action-section">
                <button id="generateBtn" class="primary-btn" data-i18n="button.generate">🌟 饮食推荐</button>
            </section>

            <!-- 推荐结果展示区 -->
            <section class="section result-section" id="resultSection" style="display: none;">
                <h2 class="section-title" data-i18n="section.result">📜 养生良方</h2>

                <!-- 饮食建议 -->
                <div class="info-card recommendation-card">
                    <h3 class="card-title" data-i18n="dish.title">🍲 时令佳肴</h3>
                    <div class="card-content" id="recommendationContent">
                        <div class="loading" id="loadingSpinner">
                            <div class="spinner"></div>
                            <p data-i18n="loading.generating">正在为您开具食疗良方...</p>
                        </div>
                    </div>
                </div>

                <!-- 营养分析 -->
                <div class="info-card nutrition-card" id="nutritionCard" style="display: none;">
                    <h3 class="card-title">📊 营养概览</h3>
                    <div class="card-content" id="nutritionContent"></div>
                    <div class="nutrition-chart">
                        <canvas id="nutritionChart"></canvas>
                    </div>
                </div>
            </section>
        </main>

        <!-- 页脚 -->
        <footer class="app-footer">
            <p>秉承《黄帝内经》养生之道</p>
            <p class="footer-note">由智能大模型开具</p>
        </footer>
    </div>

    <!-- API Key输入模态框 -->
    <div id="apiKeyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>🔑 配置API Key</h2>
            <p>请输入您的智谱AI API Key以继续使用</p>
            <div class="input-group">
                <input type="password" id="apiKeyInput" placeholder="请输入API Key (格式: id.secret)">
                <button id="saveApiKeyBtn" class="primary-btn">保存</button>
            </div>
            <div class="api-key-help">
                <p>📖 如何获取API Key:</p>
                <ol>
                    <li>访问 <a href="https://open.bigmodel.cn/" target="_blank">https://open.bigmodel.cn/</a></li>
                    <li>注册并登录账号</li>
                    <li>在控制台获取API Key</li>
                </ol>
                <p class="note">💾 API Key将保存在浏览器本地,下次无需再次输入</p>
            </div>
        </div>
    </div>

    <!-- 引入Chart.js用于图表 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- 引入国际化系统 -->
    <script src="i18n.js?v=11"></script>
    <script src="app.js?v=11"></script>
    <link rel="stylesheet" href="style.css?v=11">
</body>
</html>
