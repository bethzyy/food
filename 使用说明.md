# 🎉 养生饮食推荐应用 - 使用说明

## ⚡ 最简单的启动方式

### 双击运行：`run.bat`

就这么简单！浏览器会自动打开，即可使用。

---

## 📖 快速指南

### 1. 启动应用
```
双击 run.bat
```

### 2. 浏览器自动打开
http://localhost:8000

### 3. 使用应用
- 选择日期时间（自动填充）
- 选择位置天气（自动获取）
- 选择餐次（早/中/晚）
- 选择类型（日常/药膳）
- 点击"✨ 生成饮食推荐"

### 4. 查看推荐
- 节气信息
- 详细菜品（含制作方法）
- 营养分析
- 统计图表

---

## 🔑 API Key设置（可选）

### 方式1：环境变量（推荐）
```bash
# Windows PowerShell
$env:ZHIPU_API_KEY="你的API Key"

# Windows CMD
set ZHIPU_API_KEY=你的API Key
```
**然后在同一窗口运行 `run.bat`**

### 方式2：浏览器输入（无需设置）
直接运行 `run.bat`，首次使用会提示输入（会自动保存）

---

## 🎨 功能特色

### 智能识别
- ✅ 自动识别24节气
- ✅ 自动获取位置和天气
- ✅ 自动判断早中晚
- ✅ 四季动态主题

### 专业推荐
- ✅ 中医养生理论（四时五补、性味归经）
- ✅ 现代营养学分析
- ✅ 荤素搭配、干湿结合
- ✅ 详细制作步骤

### 中国风设计
- ✅ 雅致的中国风界面
- ✅ 四季主题配色
- ✅ 护眼柔和色调
- ✅ 简洁清晰布局

---

## 📁 核心文件

| 文件 | 说明 |
|------|------|
| `run.bat` | **一键启动**（使用这个！） |
| `app_server.py` | 统一服务器（智能支持环境变量） |
| `index.html` | 主页面 |
| `app.js` | 主程序 |
| `style.css` | 样式文件 |

---

## ⚠️ 常见问题

### Q: 设置了环境变量还是提示输入？
**A**: 确保在同一命令行窗口设置并启动：
```bash
$env:ZHIPU_API_KEY="your-key"  # 设置
python app_server.py             # 启动（同一窗口）
```

### Q: 浏览器没自动打开？
**A**: 手动访问 http://localhost:8000

### Q: 端口被占用？
**A**: 关闭其他应用或修改端口（app_server.py第18行）

### Q: 位置获取失败？
**A**: 正常现象，可手动选择天气

---

## 🆕 获取API Key

1. 访问：https://open.bigmodel.cn/
2. 注册并登录
3. 进入控制台
4. 获取API Key

---

## 📊 技术架构

```
run.bat
  ↓
app_server.py（统一服务器）
  ↓
  ├─ 环境变量检测 → ZHIPU_API_KEY
  ├─ API端点 → /api/env-api-key
  └─ 静态文件服务
      ↓
  浏览器（index.html + app.js）
    ↓
    GLM-4.7 API调用
```

---

## 🎯 使用流程

```
1. 双击 run.bat
   ↓
2. 浏览器自动打开
   ↓
3. 点击"生成饮食推荐"
   ↓
4. 自动从环境变量读取API Key
   ↓
5. 调用GLM-4.7生成推荐
   ↓
6. 显示专业饮食方案
```

---

## 📝 更新记录

### v2.0（当前版本）
- ✅ 统一服务器，简化使用
- ✅ 环境变量自动读取
- ✅ 中国风设计
- ✅ 界面优化
- ✅ 护眼配色

---

## 💡 温馨提示

1. **首次使用**：会提示输入API Key（自动保存）
2. **环境变量**：设置后无需重复输入
3. **四季主题**：自动根据节气切换
4. **数据安全**：API Key保存在本地浏览器

---

**享受健康饮食！** 🍲🥗🍜

---

## 📧 技术支持

- 问题反馈：查看 `故障排查.md`
- 自测报告：查看 `自测报告.md`
- 测试工具：运行 `python test_env_key.py`
